{% extends "base.html" %} {% block main %}

<div class="full-background rest">
	<div class="scrollable">
	
		<div class="top-bar rest-bar">
			<div class="bar-background"></div>
			<div class="menu-button">
				<button class="img-btn"></button>
				<div class="user-menu-small">
					<div class="user-picture"></div>
					<div class="text-300 user-name">{{ lang['welcome']}}<br/>{{user.first_name}} </div>
				</div>
			</div>
			<div class="rest-logo"></div>
		</div>
		
		<div class="left-menu">
			<div class="user-menu">
				<div class="user-picture"></div>
				<h2 class="text-300 user-name">{{ lang['welcome']}} {{user.first_name}}</h2>
			</div>
			<br/>
		
			<ul class="menu-items">
				<li><button class="img-btn" id="rate-more">{{ lang['rate_more']}}</button></li>
				<li><button class="img-btn" id="near-me">{{ lang['near_me']}}</button></li>
				<li><button class="img-btn" id="logout">{{ lang['log_out']}}</button></li>
			</ul>
	
		</div>
	
		<div class="rest-container">
			<img class="picture">
		
			<h2>{{place.name}}</h2>
			
			<div class="rest-right">
				<div class="rest-map">
					<img style="background-image: url(https://maps.googleapis.com/maps/api/staticmap?center={{place.address.location.lat}},{{place.address.location.lon}}&zoom=16&size=700x300&maptype=roadmap&markers=color:red%7Clabel:C%7C{{place.address.location.lat}},{{place.address.location.lon}})" >
				</div>
			</div>
		
			<div class="rest-left">
				<p class="black-text desc">Description: {{place.description}}</p>
				
				<img class="icon-address"></img>
				<p class="iconed black-text">{{place.address.street}}, {{place.address.city}} ({{place.address.province}}, {{place.address.country}})</p>
				
				<img class="icon-phone"></img>
				<p class="iconed black-text">Tel: {{place.phone}}</p>
				
				<img class="icon-hours"></img>
				<p class="iconed black-text">Opening hours: Mon: 12-14; Tue: 12-14, 18-22; Wed: 12-14; Thu: 12-14; Fri: 12-14; Sat: 12-14; Sun: closed</p>
				
				<img class="icon-closed"></img>
				<p class="iconed black-text">Closed: 15/08/2015</p>
				
				<img class="icon-web"></img>
				<p class="iconed black-text">Website: {{place.website}}</p>
				
				<img class="icon-email"></img>
				<p class="iconed black-text">Email: {{place.email}}</p>
			</div>

		</div>
	</div>
</div>

{% endblock %} {% block scripts %}
<!-- <script type="text/javascript"
	src="http://maps.googleapis.com/maps/api/js?libraries=places"></script> -->
<script type="text/javascript">
	$(window).load(function() {
		
		$('.picture').css('background-image','url({{place.picture|e}})')
		
		$('.scrollable').enscroll({
		    showOnHover: false,
		    verticalScrolling: true,
			horizontalScrolling: false,
			zIndex: 100,
		    verticalTrackClass: 'track-red',
		    verticalHandleClass: 'handle-red'
		});
		
		$('.left-menu').hide();
		var count = 1;
		$('.menu-button button').click(function(){
			if(count % 2 == 1){
				//odd time --> open left menu
				$('.left-menu').show();
				$('.user-menu-small').hide();
				count++;
			} else {
				//even time --> close left menu
				$('.left-menu').hide();
				$('.user-menu-small').show();
				count++;
			}
			
		});
		$('#rate-more').click(function(){
			window.location = '/ratings'
		});
		$('#near-me').click(function(){
			window.location = '/letsgo'
		});
		$('#logout').click(function(){
			$.ajax({
				type : 'DELETE',
				url : '/api/user/login',
				success : function() {
					window.location = '/';
				},
				error : function(resp) {
					if(window.console){
						console.log(resp);
					}
					alert("Error " + resp.status);
				}
			});
		});
		
		$('.rest-map img').click(function(){
			//TODO: goto google maps 
		});
		
		/* function initializeMap() {
			var lat = {{place.address.location.lat}};
			var lon = {{place.address.location.lon}};
			
			var myLatlng = new google.maps.LatLng(lat, lon);
			var mapOptions = {
				scrollwheel: false,
				zoom: 16,
			    center: myLatlng,
			}
			var map = new google.maps.Map(document.getElementById('rest-map'), mapOptions);
			
			var marker = new google.maps.Marker({
				icon: 'http://maps.google.com/mapfiles/ms/icons/red-dot.png',
				position: myLatlng
				map: map,
				title: {{place.name}}
			});
			
			google.maps.event.addListener(map, 'bounds_changed', function(){
				
			});
			
			
		} */
	});
</script>


{% endblock %}